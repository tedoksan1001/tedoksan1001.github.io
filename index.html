<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SÄ±nÄ±f Ã‡ekiliÅŸi</title>
<style>
body {
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    background-color: #0d0d0d;
    color: #e0e0e0;
    margin: 0;
    padding: 50px;
}
h1 {
    font-size: 2.8em;
    margin-bottom: 30px;
    color: #00ffae;
    text-shadow: 0 0 10px #00ffae, 0 0 20px #00ffae;
}
input, button {
    padding: 15px 25px;
    font-size: 18px;
    border-radius: 10px;
    border: none;
    margin: 10px 0;
}
input {
    width: 250px;
    text-align: center;
}
button {
    background-color: #1a1a1a;
    color: #00ffae;
    font-weight: bold;
    box-shadow: 0 0 10px #00ffae, 0 0 20px #00ffae;
    cursor: pointer;
    transition: all 0.3s ease;
}
button:hover {
    background-color: #00ffae;
    color: #0d0d0d;
    transform: translateY(-4px);
    box-shadow: 0 0 15px #00ffae, 0 0 30px #00ffae;
}
#sonuc {
    margin-top: 40px;
    font-size: 32px;
    font-weight: bold;
    color: #00ffae;
    text-shadow: 0 0 8px #00ffae, 0 0 15px #00ffae;
}
</style>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
<h1>ðŸŽ‰ SÄ±nÄ±f Ã‡ekiliÅŸi ðŸŽ‰</h1>

<input type="text" id="kendiIsim" placeholder="Kendi ismini yaz">
<br>
<button id="cekilisBtn" disabled>Ã‡ekiliÅŸi Yap</button>
<p id="sonuc">Bekle...</p>

<script>
// Firebase config
var firebaseConfig = {
  apiKey: "AIzaSyDXZ8Tu6o-thj0QnhSwlPCEfXYlIMPP1rY",
  authDomain: "yilbasicekilis-cfd51.firebaseapp.com",
  projectId: "yilbasicekilis-cfd51",
  storageBucket: "yilbasicekilis-cfd51.firebasestorage.app",
  messagingSenderId: "747733053754",
  appId: "1:747733053754:web:c28d081f0dd90b1da5a003"
};
firebase.initializeApp(firebaseConfig);
var db = firebase.firestore();
var kisilerRef = db.collection("kisiler");

var btn = document.getElementById("cekilisBtn");
var sonuc = document.getElementById("sonuc");
var kendiIsimInput = document.getElementById("kendiIsim");

// Kendi ismini yazÄ±nca buton aktif olsun
kendiIsimInput.addEventListener("input", function() {
    btn.disabled = kendiIsimInput.value.trim() === "";
});

// Ã‡ekiliÅŸ
btn.addEventListener("click", function(){
    var kendiIsim = kendiIsimInput.value.trim();
    if(!kendiIsim) return;

    btn.disabled = true;
    btn.innerText = "Ã‡ekiliyor...";

    kisilerRef.get().then(function(snapshot){
        var kisiler = [];
        snapshot.forEach(function(doc){
            kisiler.push({id: doc.id, isim: doc.data().isim});
        });

        if(kisiler.length === 0){
            sonuc.textContent = "TÃ¼m isimler Ã§ekildi!";
            btn.style.display = "none";
            return;
        }

        // Kendi ismini listeden Ã§Ä±kar
        kisiler = kisiler.filter(k => k.isim !== kendiIsim);

        if(kisiler.length === 0){
            sonuc.textContent = "Sadece kendi isminiz kaldÄ±, baÅŸka Ã§ekiliÅŸ yok!";
            btn.style.display = "none";
            return;
        }

        // Rastgele isim seÃ§
        var secilen = kisiler[Math.floor(Math.random() * kisiler.length)];

        // Sonucu gÃ¶ster
        sonuc.innerHTML = `<span style="animation: glow 1s ease-in-out infinite alternate;">ðŸŽ‰ ${secilen.isim} ðŸŽ‰</span>`;

        // Firestoreâ€™dan sil
        kisilerRef.doc(secilen.id).delete();

        // Hash ve txt indir
        var hash = btoa(secilen.isim);
        var blob = new Blob([hash], {type: "text/plain"});
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = secilen.isim + "_hash.txt";
        a.click();
        URL.revokeObjectURL(url);

        // Tek Ã§ekiliÅŸ, buton kaybolsun
        btn.style.display = "none";
    }).catch(function(err){
        console.error(err);
        sonuc.textContent = "Hata oluÅŸtu, konsolu kontrol et.";
        btn.disabled = false;
        btn.innerText = "Ã‡ekiliÅŸi Yap";
    });
});
</script>

<style>
@keyframes glow {
    0% { text-shadow: 0 0 5px #00ffae, 0 0 10px #00ffae; }
    50% { text-shadow: 0 0 15px #00ffae, 0 0 30px #00ffae; }
    100% { text-shadow: 0 0 5px #00ffae, 0 0 10px #00ffae; }
}
</style>
</body>
</html>